## 2. Separation of Concerns

### 2.1 Principle Definition

**Core Statement:** Presentation (themes) must remain independent from logic (plugins) and core must remain untouched. This ensures clean upgrades, modular development, and long-term maintainability.

### 2.2 Technical Foundation

Separation of Concerns (SoC) is a design principle that divides a system into distinct sections, each addressing a separate concern. In WordPress architecture, this manifests as three independent layers:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  WORDPRESS CORE                     ‚îÇ
‚îÇ  (Routing, Database, Authentication, APIs)          ‚îÇ
‚îÇ              ‚ö†Ô∏è NEVER MODIFY                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ                       ‚îÇ
         ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    PLUGINS      ‚îÇ    ‚îÇ      THEMES         ‚îÇ
‚îÇ  (Logic Layer)  ‚îÇ    ‚îÇ (Presentation Layer)‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                     ‚îÇ
‚îÇ ‚Ä¢ Data models   ‚îÇ    ‚îÇ ‚Ä¢ HTML templates    ‚îÇ
‚îÇ ‚Ä¢ Business      ‚îÇ    ‚îÇ ‚Ä¢ CSS styling       ‚îÇ
‚îÇ   logic         ‚îÇ    ‚îÇ ‚Ä¢ JavaScript UI     ‚îÇ
‚îÇ ‚Ä¢ Integrations  ‚îÇ    ‚îÇ ‚Ä¢ Display logic     ‚îÇ
‚îÇ ‚Ä¢ Workflows     ‚îÇ    ‚îÇ   ONLY              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.3 Why This Matters

**Upgrade Safety:** When WordPress releases version updates, core files are completely replaced. Any modifications to core are lost. By keeping customizations in themes and plugins, upgrades become safe and routine.

**Modularity:** Themes can be switched without losing functionality. Plugins can be activated/deactivated independently. This modular approach enables testing, troubleshooting, and incremental development.

**Maintainability:** Clear boundaries reduce complexity. Developers know exactly where to implement features‚Äîbusiness logic goes in plugins, presentation goes in themes.

### 2.4 Correct Implementation

**‚ùå INCORRECT - Logic in Theme:**

```php
// functions.php (THEME)
// ‚ùå BAD: Business logic in presentation layer
function process_payment($order_id) {
    $order = get_post($order_id);
    $stripe = new StripeAPI();
    $charge = $stripe->charge([
        'amount' => get_post_meta($order_id, '_total', true),
        'customer' => get_post_meta($order_id, '_customer_id', true)
    ]);
    
    if ($charge->success) {
        update_post_meta($order_id, '_payment_status', 'paid');
        send_order_confirmation_email($order_id);
    }
}
add_action('order_submit', 'process_payment');
```

**Problem:** If the user switches themes, payment processing breaks. Critical business logic should never depend on the active theme.

**‚úÖ CORRECT - Logic in Plugin:**

```php
// Plugin: ecommerce-payment-handler/payment-handler.php
// ‚úÖ GOOD: Business logic in plugin
function process_payment($order_id) {
    $order = get_post($order_id);
    $stripe = new StripeAPI();
    $charge = $stripe->charge([
        'amount' => get_post_meta($order_id, '_total', true),
        'customer' => get_post_meta($order_id, '_customer_id', true)
    ]);
    
    if ($charge->success) {
        update_post_meta($order_id, '_payment_status', 'paid');
        send_order_confirmation_email($order_id);
    }
}
add_action('order_submit', 'process_payment');
```

```php
// Theme: single-order.php
// ‚úÖ GOOD: Theme only handles display
<?php get_header(); ?>

<div class="order-details">
    <h1>Order #<?php echo get_the_ID(); ?></h1>
    
    <div class="order-status">
        Status: <?php echo esc_html(get_post_meta(get_the_ID(), '_payment_status', true)); ?>
    </div>
    
    <div class="order-total">
        Total: $<?php echo esc_html(get_post_meta(get_the_ID(), '_total', true)); ?>
    </div>
</div>

<?php get_footer(); ?>
```

### 2.5 Decision Matrix

|Functionality|Plugin|Theme|Core|
|---|---|---|---|
|Payment processing|‚úì|‚úó|‚úó|
|Custom post types|‚úì|‚úó|‚úó|
|Email notifications|‚úì|‚úó|‚úó|
|API integrations|‚úì|‚úó|‚úó|
|Data validation|‚úì|‚úó|‚úó|
|HTML structure|‚úó|‚úì|‚úó|
|CSS styling|‚úó|‚úì|‚úó|
|Layout templates|‚úó|‚úì|‚úó|
|Color schemes|‚úó|‚úì|‚úó|
|Typography|‚úó|‚úì|‚úó|
|Routing system|‚úó|‚úó|‚úì|
|Database abstraction|‚úó|‚úó|‚úì|
|Authentication|‚úó|‚úó|‚úì|

### 2.6 Real-World Impact

**Case Study: E-commerce Site Migration**

A company built an online store with all business logic in their custom theme. After 3 years, they wanted to rebrand with a new design.

**Without SoC:**

- Must rebuild all payment processing, inventory management, and order workflows
- 6-month project, high risk of bugs
- Cannot test new design without breaking functionality

**With SoC:**

- Business logic already in e-commerce plugin
- Switch theme in 1 day
- Test new design on staging without touching functionality
- Roll back instantly if issues arise

### 2.7 Gray Areas & Exceptions

**Theme-Specific Features:** Some display-related functionality can live in themes via `functions.php`:

- Custom image sizes: `add_image_size()`
- Widget areas: `register_sidebar()`
- Menu locations: `register_nav_menus()`
- Theme support flags: `add_theme_support()`

**Rule of thumb:** If removing the theme would break user data or critical site functionality, it belongs in a plugin.

---

## 3. Extensibility via Hooks

### 3.1 Principle Definition

**Core Statement:** Actions and filters allow injection or modification of logic at specific lifecycle points without editing core. Enables infinite customization while preserving compatibility.

### 3.2 Technical Foundation

WordPress implements the Observer pattern through its hook system. Hooks are named events where developers can inject custom code without modifying core files or original plugin code.

**Hook Architecture:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         WordPress Execution Flow              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                               ‚îÇ
‚îÇ  Core executes:                               ‚îÇ
‚îÇ  do_action('init');                           ‚îÇ
‚îÇ         ‚îÇ                                     ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚ñ∫ Triggers all callbacks           ‚îÇ
‚îÇ              registered to 'init' hook        ‚îÇ
‚îÇ                                               ‚îÇ
‚îÇ  Plugin A: add_action('init', 'funcA', 10);  ‚îÇ
‚îÇ  Plugin B: add_action('init', 'funcB', 20);  ‚îÇ
‚îÇ  Plugin C: add_action('init', 'funcC', 5);   ‚îÇ
‚îÇ                                               ‚îÇ
‚îÇ  Execution order (by priority):               ‚îÇ
‚îÇ  1. funcC (priority 5)                        ‚îÇ
‚îÇ  2. funcA (priority 10, default)              ‚îÇ
‚îÇ  3. funcB (priority 20)                       ‚îÇ
‚îÇ                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3.3 Actions vs Filters

**Actions (do_action):**

- Execute code at specific points
- Do not return values
- Used for side effects (send email, log event, register post type)

**Filters (apply_filters):**

- Modify data before it's used
- Must return a value
- Used for transformations (change post title, modify query, alter HTML output)

### 3.4 Action Hook Implementation

**Example 1: Sending Notification on Post Publication**

```php
// WordPress core fires this action
// File: wp-includes/post.php
do_action('publish_post', $post_id, $post);

// Your plugin listens and responds
add_action('publish_post', 'notify_team_on_publish', 10, 2);

function notify_team_on_publish($post_id, $post) {
    // Only for 'news' category
    if (!has_category('news', $post)) {
        return;
    }
    
    $team_emails = ['editor@example.com', 'manager@example.com'];
    $subject = 'New article published: ' . $post->post_title;
    $message = "A new article has been published:\n\n";
    $message .= "Title: {$post->post_title}\n";
    $message .= "URL: " . get_permalink($post_id) . "\n";
    $message .= "Author: " . get_the_author_meta('display_name', $post->post_author);
    
    foreach ($team_emails as $email) {
        wp_mail($email, $subject, $message);
    }
    
    // Log to custom analytics
    do_action('analytics_track_event', 'post_published', [
        'post_id' => $post_id,
        'category' => 'news'
    ]);
}
```

**Example 2: Custom Initialization Logic**

```php
// Register custom post types on init
add_action('init', 'register_custom_content_types');

function register_custom_content_types() {
    // Register 'product' post type
    register_post_type('product', [
        'labels' => [
            'name' => 'Products',
            'singular_name' => 'Product'
        ],
        'public' => true,
        'has_archive' => true,
        'supports' => ['title', 'editor', 'thumbnail'],
        'show_in_rest' => true
    ]);
    
    // Register 'product_category' taxonomy
    register_taxonomy('product_category', 'product', [
        'label' => 'Product Categories',
        'hierarchical' => true,
        'show_in_rest' => true
    ]);
}
```

### 3.5 Filter Hook Implementation

**Example 1: Modifying Post Content**

```php
// WordPress core applies filter
// File: wp-includes/post-template.php
$content = apply_filters('the_content', $content);

// Your plugin modifies the content
add_filter('the_content', 'add_estimated_reading_time', 10);

function add_estimated_reading_time($content) {
    // Only on single post pages
    if (!is_single()) {
        return $content;
    }
    
    // Calculate reading time
    $word_count = str_word_count(strip_tags($content));
    $reading_time = ceil($word_count / 200); // 200 words per minute
    
    // Create reading time notice
    $reading_notice = sprintf(
        '<div class="reading-time" style="padding: 10px; background: #f0f0f0; margin-bottom: 20px;">
            <strong>‚è± Estimated reading time:</strong> %d %s
        </div>',
        $reading_time,
        $reading_time === 1 ? 'minute' : 'minutes'
    );
    
    // Prepend to content
    return $reading_notice . $content;
}
```

**Example 2: Modifying Query Parameters**

```php
// Modify main query before execution
add_action('pre_get_posts', 'exclude_category_from_home');

function exclude_category_from_home($query) {
    // Only modify main query on home page
    if (!$query->is_main_query() || !$query->is_home()) {
        return;
    }
    
    // Exclude category ID 5 (e.g., "Internal News")
    $query->set('cat', '-5');
}
```

**Example 3: Chaining Multiple Filters**

```php
// First filter: Convert to uppercase
add_filter('the_title', 'make_title_uppercase', 10);
function make_title_uppercase($title) {
    return strtoupper($title);
}

// Second filter: Add emoji (runs after uppercase due to priority)
add_filter('the_title', 'add_title_emoji', 20);
function add_title_emoji($title) {
    return 'üìù ' . $title;
}

// Third filter: Wrap in span (runs last)
add_filter('the_title', 'wrap_title_in_span', 30);
function wrap_title_in_span($title) {
    return '<span class="custom-title">' . $title . '</span>';
}

// Original title: "Hello World"
// After all filters: <span class="custom-title">üìù HELLO WORLD</span>
```

### 3.6 Creating Custom Hooks

**Define Your Own Hooks in Plugins:**

```php
// In your plugin's main function
function process_order($order_id) {
    // Allow others to run code before processing
    do_action('before_order_processing', $order_id);
    
    // Get order data
    $order_data = get_order_data($order_id);
    
    // Allow others to modify order data
    $order_data = apply_filters('order_data_before_processing', $order_data, $order_id);
    
    // Process payment
    $payment_result = process_payment($order_data);
    
    // Allow others to modify payment result
    $payment_result = apply_filters('payment_result', $payment_result, $order_id);
    
    // Save order
    save_order($order_id, $order_data, $payment_result);
    
    // Allow others to run code after processing
    do_action('after_order_processing', $order_id, $payment_result);
    
    return $payment_result;
}
```

**Other Plugins Can Hook Into Your Plugin:**

```php
// Another developer's plugin extends your functionality
add_filter('order_data_before_processing', 'apply_loyalty_discount', 10, 2);

function apply_loyalty_discount($order_data, $order_id) {
    $customer_id = $order_data['customer_id'];
    $total_orders = get_customer_order_count($customer_id);
    
    // 10% discount for customers with 10+ orders
    if ($total_orders >= 10) {
        $order_data['discount'] = $order_data['total'] * 0.10;
        $order_data['total'] = $order_data['total'] * 0.90;
        $order_data['discount_reason'] = 'Loyalty discount (10+ orders)';
    }
    
    return $order_data;
}

// Send Slack notification after order processing
add_action('after_order_processing', 'notify_slack_on_order', 10, 2);

function notify_slack_on_order($order_id, $payment_result) {
    if ($payment_result['status'] === 'success') {
        $webhook_url = 'https://hooks.slack.com/services/YOUR/WEBHOOK/URL';
        $message = sprintf(
            'New order #%d processed successfully. Amount: $%s',
            $order_id,
            number_format($payment_result['amount'], 2)
        );
        
        wp_remote_post($webhook_url, [
            'body' => json_encode(['text' => $message])
        ]);
    }
}
```

### 3.7 Hook Priority System

```php
// Lower priority = runs first
add_action('init', 'runs_first', 5);
add_action('init', 'runs_second', 10);  // Default priority
add_action('init', 'runs_third', 15);
add_action('init', 'runs_last', 999);

// Same priority = runs in order of registration
add_action('save_post', 'function_a', 10);
add_action('save_post', 'function_b', 10);  // Runs after function_a
```

### 3.8 Removing Hooks

```php
// Remove a specific hook
remove_action('wp_head', 'wp_generator');

// Remove filter
remove_filter('the_content', 'wpautop');

// Remove all hooks from an action
remove_all_actions('wp_footer');

// Remove all filters from a filter hook
remove_all_filters('the_title');
```

### 3.9 Common Core Hooks

**Initialization Hooks:**

```
muplugins_loaded    ‚Üí Must-use plugins loaded
plugins_loaded      ‚Üí All plugins loaded
after_setup_theme   ‚Üí Theme functions.php loaded
init                ‚Üí WordPress fully initialized
wp_loaded           ‚Üí All PHP files loaded
```

**Query Hooks:**

```
pre_get_posts       ‚Üí Before main query runs
posts_selection     ‚Üí After posts retrieved
the_post            ‚Üí During loop iteration
loop_start          ‚Üí Beginning of loop
loop_end            ‚Üí End of loop
```

**Content Hooks:**

```
the_title           ‚Üí Filter post title
the_content         ‚Üí Filter post content
the_excerpt         ‚Üí Filter post excerpt
wp_head             ‚Üí Before </head> tag
wp_footer           ‚Üí Before </body> tag
```

**Admin Hooks:**

```
admin_init          ‚Üí Admin initialization
admin_menu          ‚Üí Admin menu registration
save_post           ‚Üí Post save/update
admin_notices       ‚Üí Admin notifications
```

### 3.10 Real-World Impact

**Scenario: Adding Social Sharing Without Theme Modification**

Without hooks, you'd need to:

1. Edit theme template files directly
2. Risk breaking on theme updates
3. Repeat for every template (single.php, page.php, etc.)

With hooks:

```php
// Plugin adds social buttons via hook
add_filter('the_content', 'add_social_sharing_buttons', 20);

function add_social_sharing_buttons($content) {
    if (!is_single()) {
        return $content;
    }
    
    $post_url = urlencode(get_permalink());
    $post_title = urlencode(get_the_title());
    
    $buttons = '<div class="social-sharing">';
    $buttons .= sprintf(
        '<a href="https://twitter.com/intent/tweet?url=%s&text=%s" target="_blank">Share on Twitter</a>',
        $post_url,
        $post_title
    );
    $buttons .= sprintf(
        '<a href="https://www.facebook.com/sharer.php?u=%s" target="_blank">Share on Facebook</a>',
        $post_url
    );
    $buttons .= '</div>';
    
    return $content . $buttons;
}
```

Result: Works with any theme, survives theme updates, can be disabled by deactivating plugin.

---

## 4. Least Privilege Security Model

### 4.1 Principle Definition

**Core Statement:** Access control based on roles & capabilities ensures restricted operational boundaries. Minimizes vulnerability scope and protects administrative workflows across multi-user environments.

### 4.2 Technical Foundation

WordPress implements a two-tier security model:

1. **Roles**: Named collections of capabilities (e.g., Administrator, Editor, Author)
2. **Capabilities**: Specific permissions (e.g., `edit_posts`, `manage_options`, `delete_users`)

**Security Hierarchy:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          ADMINISTRATOR                       ‚îÇ
‚îÇ  Full site control                           ‚îÇ
‚îÇ  ‚Ä¢ manage_options                            ‚îÇ
‚îÇ  ‚Ä¢ edit_users, delete_users                  ‚îÇ
‚îÇ  ‚Ä¢ install_plugins, install_themes           ‚îÇ
‚îÇ  ‚Ä¢ unfiltered_html                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ                ‚îÇ
       ‚ñº                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   EDITOR    ‚îÇ  ‚îÇ  SHOP MANAGER   ‚îÇ
‚îÇ             ‚îÇ  ‚îÇ  (Custom Role)  ‚îÇ
‚îÇ ‚Ä¢ publish   ‚îÇ  ‚îÇ  ‚Ä¢ manage       ‚îÇ
‚îÇ   posts     ‚îÇ  ‚îÇ    products     ‚îÇ
‚îÇ ‚Ä¢ manage    ‚îÇ  ‚îÇ  ‚Ä¢ view orders  ‚îÇ
‚îÇ   categories‚îÇ  ‚îÇ  ‚Ä¢ edit shop    ‚îÇ
‚îÇ ‚Ä¢ moderate  ‚îÇ  ‚îÇ    settings     ‚îÇ
‚îÇ   comments  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   AUTHOR    ‚îÇ
‚îÇ             ‚îÇ
‚îÇ ‚Ä¢ publish   ‚îÇ
‚îÇ   own posts ‚îÇ
‚îÇ ‚Ä¢ upload    ‚îÇ
‚îÇ   files     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ CONTRIBUTOR ‚îÇ
‚îÇ             ‚îÇ
‚îÇ ‚Ä¢ write     ‚îÇ
‚îÇ   posts     ‚îÇ
‚îÇ ‚Ä¢ edit own  ‚îÇ
‚îÇ   posts     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SUBSCRIBER  ‚îÇ
‚îÇ             ‚îÇ
‚îÇ ‚Ä¢ read      ‚îÇ
‚îÇ   content   ‚îÇ
‚îÇ ‚Ä¢ comment   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 4.3 Default WordPress Roles

|Role|Key Capabilities|Typical Use Case|
|---|---|---|
|**Administrator**|All capabilities including site management|Site owner, lead developer|
|**Editor**|Publish/manage all content, moderate comments|Content manager, editorial lead|
|**Author**|Publish/manage own posts, upload media|Regular content creator|
|**Contributor**|Write/edit own unpublished posts|Guest writer, intern|
|**Subscriber**|Read content, manage own profile|Registered member|

### 4.4 Checking Capabilities in Code

**Never Check Roles‚ÄîAlways Check Capabilities:**

```php
// ‚ùå INCORRECT: Checking user role
if (current_user_can('administrator')) {
    // Do something
}

// ‚úÖ CORRECT: Checking capability
if (current_user_can('manage_options')) {
    // Do something
}
```

**Why?** Custom roles might have `manage_options` capability but not be named "administrator". Capability checks are flexible and future-proof.

**Practical Examples:**

```php
// Protect admin page
function render_settings_page() {
    // Check if user has permission
    if (!current_user_can('manage_options')) {
        wp_die(__('You do not have sufficient permissions to access this page.'));
    }
    
    // Render settings page
    ?>
    <div class="wrap">
        <h1>Settings</h1>
        <!-- Settings form -->
    </div>
    <?php
}

// Protect custom functionality
function delete_user_account($user_id) {
    // Check capability
    if (!current_user_can('delete_users')) {
        return new WP_Error(
            'insufficient_permissions',
            'You do not have permission to delete users.'
        );
    }
    
    // Additional check: Can't delete yourself
    if ($user_id == get_current_user_id()) {
        return new WP_Error(
            'cannot_delete_self',
            'You cannot delete your own account.'
        );
    }
    
    // Proceed with deletion
    wp_delete_user($user_id);
}

// Protect AJAX endpoints
add_action('wp_ajax_fetch_analytics', 'handle_fetch_analytics');

function handle_fetch_analytics() {
    // Verify nonce
    check_ajax_referer('analytics_nonce', 'nonce');
    
    // Check capability
    if (!current_user_can('view_analytics')) {  // Custom capability
        wp_send_json_error(['message' => 'Insufficient permissions']);
        return;
    }
    
    // Fetch and return data
    $data = get_analytics_data();
    wp_send_json_success($data);
}
```

### 4.5 Creating Custom Roles

```php
// Add custom role on plugin activation
register_activation_hook(__FILE__, 'create_custom_roles');

function create_custom_roles() {
    // Create Shop Manager role
    add_role('shop_manager', 'Shop Manager', [
        'read' => true,
        'edit_posts' => false,
        'delete_posts' => false,
        'manage_shop_settings' => true,    // Custom capability
        'view_orders' => true,              // Custom capability
        'edit_products' => true,            // Custom capability
        'delete_products' => true           // Custom capability
    ]);
    
    // Create Support Agent role
    add_role('support_agent', 'Support Agent', [
        'read' => true,
        'view_support_tickets' => true,     // Custom capability
        'reply_to_tickets' => true,         // Custom capability
        'close_tickets' => false            // Can't close, only reply
    ]);
}

// Remove custom roles on plugin deactivation
register_deactivation_hook(__FILE__, 'remove_custom_roles');

function remove_custom_roles() {
    remove_role('shop_manager');
    remove_role('support_agent');
}
```

### 4.6 Adding Capabilities to Existing Roles

```php
// Add custom capability to Administrator role
function add_custom_capabilities() {
    $admin_role = get_role('administrator');
    $admin_role->add_cap('manage_advanced_settings');
    $admin_role->add_cap('view_system_logs');
    
    $editor_role = get_role('editor');
    $editor_role->add_cap('view_analytics');
}
add_action('admin_init', 'add_custom_capabilities');

// Remove capability
function remove_custom_capability() {
    $role = get_role('editor');
    $role->remove_cap('view_analytics');
}
```

### 4.7 Dynamic Capability Checks

```php
// Check if user can edit specific post
if (current_user_can('edit_post', $post_id)) {
    // Allow editing
}

// Check if user can delete specific post
if (current_user_can('delete_post', $post_id)) {
    // Allow deletion
}

// Check if user can edit specific user
if (current_user_can('edit_user', $user_id)) {
    // Allow user editing
}
```

### 4.8 Protecting REST API Endpoints

```php
register_rest_route('myapp/v1', '/products', [
    'methods' => 'POST',
    'callback' => 'create_product',
    'permission_callback' => function() {
        return current_user_can('edit_products');
    },
    'args' => [
        'title' => [
            'required' => true,
            'validate_callback' => function($param) {
                return is_string($param) && strlen($param) > 0;
            },
            'sanitize_callback' => 'sanitize_text_field'
        ]
    ]
]);

register_rest_route('myapp/v1', '/admin/logs', [
    'methods' => 'GET',
    'callback' => 'get_system_logs',
    'permission_callback' => function() {
        // Only administrators can view logs
        return current_user_can('manage_options');
    }
]);
```

### 4.9 Security Best Practices

**1. Nonce Verification:**

```php
// Generate nonce
wp_nonce_field('delete_product_action', 'delete_product_nonce');

// Verify nonce
if (!isset($_POST['delete_product_nonce']) || 
    !wp_verify_nonce($_POST['delete_product_nonce'], 'delete_product_action')) {
    wp_die('Security check failed');
}
```

**2. Data Sanitization:**

```php
// Sanitize user input
$title = sanitize_text_field($_POST['title']);
$email = sanitize_email($_POST['email']);
$url = esc_url_raw($_POST['url']);
$html = wp_kses_post($_POST['content']);  // Allow safe HTML
$integer = absint($_POST['quantity']);
```

**3. Data Escaping on Output:**

```php
// Escape for HTML
echo esc_html($user_input);

// Escape for attributes
echo '<input value="' . esc_attr($user_input) . '">';

// Escape for URLs
echo '<a href="' . esc_url($user_url) . '">Link</a>';

// Escape for JavaScript
echo '<script>var data = "' . esc_js($user_input) . '";</script>';
```

**4. Prepared SQL Statements:**

```php
global $wpdb;

// ‚ùå DANGEROUS: SQL injection vulnerable
$user_id = $_GET['user_id'];
$wpdb->get_results("SELECT * FROM {$wpdb->posts} WHERE post_author = $user_id");

// ‚úÖ SAFE: Prepared statement
$user_id = $_GET['user_id'];
$wpdb->get_results($wpdb->prepare(
    "SELECT * FROM {$wpdb->posts} WHERE post_author = %d",
    $user_id
));
```

### 4.10 Real-World Scenario

**Multi-Author Blog with Guest Contributors:**

```php
// Custom capability for viewing draft posts from all authors
function add_draft_viewer_capability() {
    $editor = get_role('editor');
    $editor->add_cap('view_all_drafts');
}
add_action('admin_init', 'add_draft_viewer_capability');

// Modify query to show all drafts to editors
add_action('pre_get_posts', 'show_all_drafts_to_editors');

function show_all_drafts_to_editors($query) {
    if (!is_admin() || !$query->is_main_query()) {
        return;
    }
    
    // Only on post list screen
    if ($query->get('post_type') !== 'post') {
        return;
    }
    
    // If user can view all drafts, show all authors' drafts
    if (current_user_can('view_all_drafts')) {
        $query->set('post_status', ['publish', 'draft', 'pending']);
    }
}

// Hide sensitive menu items from contributors
add_action('admin_menu', 'remove_menu_items_for_contributors');

function remove_menu_items_for_contributors() {
    if (!current_user_can('publish_posts')) {
        // Contributors can't see these
        remove_menu_page('tools.php');
        remove_menu_page('options-general.
php'); } }

```

---

## 5. Backward Compatibility Commitment

### 5.1 Principle Definition

**Core Statement:** WordPress prioritizes upgrade stability, allowing legacy systems to survive major version changes. Ensures safety in enterprise and long-lived production deployments.

### 5.2 Technical Philosophy

WordPress maintains backward compatibility by:
1. Never removing functions‚Äîonly deprecating them
2. Preserving database structure across versions
3. Maintaining consistent API signatures
4. Providing long deprecation cycles (often 3+ years)
5. Including compatibility layers for old code

**Version Evolution Example:**

```

WordPress 3.0 (2010): Introduces custom post types WordPress 4.0 (2014): Adds REST API WordPress 5.0 (2018): Introduces Gutenberg editor WordPress 6.0 (2023): Full Site Editing

Legacy plugin from 2011 ‚Üí Still works in 2023

````

### 5.3 Deprecation Process

**Stage 1: Function Still Works, Deprecation Notice Added**

```php
// WordPress 4.5
function get_currentuserinfo() {
    _deprecated_function(__FUNCTION__, '4.5.0', 'wp_get_current_user()');
    return wp_get_current_user();
}

// Old code still works
get_currentuserinfo();  // ‚úì Works but triggers notice in debug mode
````

**Stage 2: Function Documented as Deprecated (Years Pass)**

```php
// Documentation updated
// Codex/Developer Handbook marks function as deprecated
// Plugin repository checks warn about deprecated functions
```

**Stage 3: Function Eventually Removed (Rare, Only After Many Years)**

```php
// WordPress 7.0 (hypothetical, years later)
// Function finally removed
// By now, virtually all code has migrated to new function
```

### 5.4 Handling Deprecated Functions

**Check for Deprecated Functions:**

```php
// Enable WordPress debug mode (wp-config.php)
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);

// Deprecated function usage logs to debug.log:
// PHP Deprecated: Function get_currentuserinfo is deprecated since version 4.5.0!
// Use wp_get_current_user() instead.
```

**Migration Example:**

```php
// ‚ùå OLD (Deprecated in WordPress 4.5)
$user = get_currentuserinfo();

// ‚úÖ NEW (Current standard)
$user = wp_get_current_user();

// Both return same data structure, smooth transition
```

### 5.5 Database Schema Stability

WordPress preserves database structure while adding new features through:

**Adding Fields, Not Changing Them:**

```sql
-- WordPress 3.0 database
CREATE TABLE wp_posts (
  ID bigint(20) unsigned NOT NULL auto_increment,
  post_author bigint(20) unsigned NOT NULL default '0',
  post_date datetime NOT NULL default '0000-00-00 00:00:00',
  post_content longtext NOT NULL,
  ...
);

-- WordPress 6.0 database (same structure, fields added over time)
CREATE TABLE wp_posts (
  ID bigint(20) unsigned NOT NULL auto_increment,
  post_author bigint(20) unsigned NOT NULL default '0',
  post_date datetime NOT NULL default '0000-00-00 00:00:00',
  post_content longtext NOT NULL,
  ...
  -- New fields added, old fields unchanged
);
```

### 5.6 API Consistency

**Function Signatures Remain Stable:**

```php
// WordPress 3.0
get_posts(array $args);

// WordPress 6.0 (same signature, more options in $args)
get_posts(array $args);

// Old code works
$posts = get_posts(['numberposts' => 5]);  // ‚úì Still works

// New code uses expanded options
$posts = get_posts([
    'numberposts' => 5,
    'meta_query' => [...],     // Added in WP 3.1
    'tax_query' => [...],      // Added in WP 3.1
    'date_query' => [...]      // Added in WP 3.7
]);
```

### 5.7 Maintaining Plugin Compatibility

**Write Future-Proof Code:**

```php
// ‚úÖ GOOD: Check if function exists before using
if (function_exists('wp_enqueue_media')) {
    wp_enqueue_media();  // Added in WP 3.5
} else {
    // Fallback for older versions
    wp_enqueue_script('media-upload');
    wp_enqueue_script('thickbox');
}

// ‚úÖ GOOD: Check WordPress version
global $wp_version;
if (version_compare($wp_version, '5.0', '>=')) {
    // Use Gutenberg features
} else {
    // Use classic editor features
}

// ‚úÖ GOOD: Use constants that handle version differences
if (defined('REST_REQUEST') && REST_REQUEST) {
    // Handle REST request
}
```

**Specify Minimum WordPress Version:**

```php
/**
 * Plugin Name: My Plugin
 * Requires at least: 5.0
 * Requires PHP: 7.4
 */

// Check version on activation
register_activation_hook(__FILE__, 'check_wordpress_version');

function check_wordpress_version() {
    global $wp_version;
    
    if (version_compare($wp_version, '5.0', '<')) {
        deactivate_plugins(plugin_basename(__FILE__));
        wp_die(
            'This plugin requires WordPress 5.0 or higher. ' .
            'You are running version ' . $wp_version . '.'
        );
    }
}
```

### 5.8 Handling Breaking Changes

WordPress rarely introduces breaking changes, but when necessary:

**Example: jQuery Migration (WordPress 5.5+)**

```php
// WordPress 5.5+ removed jQuery Migrate by default
// Old jQuery code that relied on deprecated methods broke

// Solution: Re-enable jQuery Migrate if needed
add_action('wp_enqueue_scripts', 'reenable_jquery_migrate');

function reenable_jquery_migrate() {
    if (!is_admin()) {
        wp_enqueue_script('jquery-migrate');
    }
}

// Better: Update jQuery code to modern standards
// OLD: $().click()
// NEW: $(document).on('click', selector, handler)
```

### 5.9 Real-World Impact

**Case Study: Enterprise Site Running 10-Year-Old Plugin**

A large university runs a custom course registration plugin built in 2013 for WordPress 3.5. In 2023, they upgrade to WordPress 6.2.

**Without Backward Compatibility:**

- Plugin would break completely
- Must rebuild from scratch ($50k+ cost)
- Risk of data loss
- Months of downtime

**With Backward Compatibility:**

- Plugin continues working
- Deprecation warnings in logs guide modernization
- Can upgrade gradually
- Zero downtime
- Optional modernization at their own pace

### 5.10 Trade-offs

**Benefits:**

- ‚úì Safe upgrades for production sites
- ‚úì Lower maintenance costs
- ‚úì Larger ecosystem compatibility
- ‚úì Trust in platform stability

**Costs:**

- ‚úó Accumulated technical debt in core
- ‚úó Larger codebase maintaining legacy code
- ‚úó Slower adoption of modern PHP features
- ‚úó Performance overhead from compatibility layers

---

## 6. Performance First Discipline

### 6.1 Principle Definition

**Core Statement:** Efficient queries, caching, asset optimization, and minimal plugin footprint are mandatory for scalable engineering. Poor structural decisions compound at scale.

### 6.2 Performance Impact Chain

```
Poor Database Query
        ‚Üì
Slow Page Load (3+ seconds)
        ‚Üì
High Server Load
        ‚Üì
Increased Infrastructure Cost
        ‚Üì
Poor User Experience
        ‚Üì
Lower Conversion Rates
        ‚Üì
Business Impact
```

### 6.3 Database Query Optimization

**‚ùå INEFFICIENT: N+1 Query Problem**

```php
// Fetch 100 posts
$posts = get_posts(['numberposts' => 100]);

foreach ($posts as $post) {
    // Each iteration makes a separate database query
    $author_name = get_the_author_meta('display_name', $post->post_author);  // Query 1
    $thumbnail = get_the_post_thumbnail_url($post->ID);                      // Query 2
    $categories = get_the_category($post->ID);                                // Query 3
}

// Total queries: 1 (initial) + (100 √ó 3) = 301 queries
```

**‚úÖ EFFICIENT: Optimized with Proper Caching**

```php
// Fetch posts with metadata preloaded
$posts = get_posts([
    'numberposts' => 100,
    'update_post_meta_cache' => true,     // Preload all post meta
    'update_post_term_cache' => true      // Preload all taxonomy terms
]);

foreach ($posts as $post) {
    // These now use cached data‚Äîno additional queries
    $author_name = get_the_author_meta('display_name', $post->post_author);
    $thumbnail = get_the_post_thumbnail_url($post->ID);
    $categories = get_the_category($post->ID);
}

// Total queries: ~5-10 queries (batch loaded)
```

**WP_Query Optimization Flags:**

```php
$query = new WP_Query([
    'post_type' => 'product',
    'posts_per_page' => 50,
    
    // Performance optimizations
    'no_found_rows' => true,              // Skip counting total results (saves query)
    'update_post_meta_cache' => false,    // Don't load post meta if not needed
    'update_post_term_cache' => false,    // Don't load taxonomies if not needed
    'fields' => 'ids'                     // Only return IDs, not full objects
]);
```

### 6.4 Caching Strategies

**Object Caching:**

```php
// Check cache first
$cache_key = 'featured_products_' . md5(serialize($args));
$products = wp_cache_get($cache_key, 'product_group');

if (false === $products) {
    // Cache miss‚Äîquery database
    $query = new WP_Query($args);
    $products = $query->posts;
    
    // Store in cache for 1 hour
    wp_cache_set($cache_key, $products, 'product_group', 3600);
}

return $products;
```

**Transient API (Stored in Database):**

```php
// Check for cached data
$analytics = get_transient('daily_analytics');

if (false === $analytics) {
    // Cache miss‚Äîfetch from external API
    $response = wp_remote_get('https://api.analytics.com/data');
    $analytics = json_decode(wp_remote_retrieve_body($response), true);
    
    // Cache for 24 hours
    set_transient('daily_analytics', $analytics, DAY_IN_SECONDS);
}

return $analytics;
```

**Page Caching (via Plugin or Server):**

```
Request ‚Üí Nginx/Varnish ‚Üí Cached HTML (served immediately)
   ‚Üì
   ‚îî‚îÄ‚ñ∫ If cache miss, generate page and cache result
```

### 6.5 Asset Optimization

**Enqueue Scripts Properly:**

```php
function enqueue_optimized_assets() {
    // Load jQuery from WordPress (don't include separately)
    // Already optimized and cached across sites
    wp_enqueue_script('jquery');
    
    // Load custom script in footer (non-blocking)
    wp_enqueue_script(
        'custom-script',
        get_template_directory_uri() . '/js/custom.js',
        ['jquery'],        // Dependencies
        '1.0.0',          // Version
        true              // Load in footer
    );
    
    // Minify CSS
    wp_enqueue_style(
        'main-style',
        get_template_directory_uri() . '/css/style.min.css',
        [],
        '1.0.0'
    );
    
    // Only load on specific pages
    if (is_singular('product')) {
        wp_enqueue_script('product-gallery');
    }
}
add_action('wp_enqueue_scripts', 'enqueue_optimized_assets');
```

**Conditional Loading:**

```php
// ‚ùå BAD: Load everywhere
wp_enqueue_script('contact-form');

// ‚úÖ GOOD: Load only where needed
if (is_page('contact')) {
    wp_enqueue_script('contact-form');
}

// ‚úÖ GOOD: Load only in admin
add_action('admin_enqueue_scripts', function($hook) {
    if ('toplevel_page_my-plugin' !== $hook) {
        return;
    }
    wp_enqueue_script('my-admin-script');
});
```

### 6.6 Image Optimization

```php
// Generate multiple image sizes
add_action('after_setup_theme', 'register_image_sizes');

function register_image_sizes() {
    // Thumbnail for grids
    add_image_size('product-thumb', 300, 300, true);
    
    // Medium for single product page
    add_image_size('product-single', 600, 600, true);
    
    // Large for gallery
    add_image_size('product-gallery', 1200, 1200, false);
}

// Use appropriate size in templates
<?php
// Don't load full-size 4000px image for 300px thumbnail
the_post_thumbnail('product-thumb');  // ‚úÖ Optimized
?>
```

**Lazy Loading (Native in WordPress 5.5+):**

```html
<!-- WordPress automatically adds loading="lazy" -->
<img src="image.jpg" loading="lazy" alt="Product">
```

### 6.7 Database Indexing

**Custom Table with Proper Indexes:**

```php
global $wpdb;
$table_name = $wpdb->prefix . 'analytics_events';

$sql = "CREATE TABLE $table_name (
    id bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    user_id bigint(20) unsigned NOT NULL,
    event_type varchar(50) NOT NULL,
    event_data longtext,
    created_at datetime NOT NULL,
    PRIMARY KEY  (id),
    KEY user_id (user_id),           -- Index for user queries
    KEY event_type (event_type),      -- Index for event type queries
    KEY created_at (created_at)       -- Index for date queries
) {$wpdb->get_charset_collate()};";

require_once(ABSPATH . 'wp-admin/includes/upgrade.php');
dbDelta($sql);
```

### 6.8 Avoiding Resource-Intensive Operations

**‚ùå SLOW: Processing in Real-Time**

```php
add_action('publish_post', 'generate_social_images');

function generate_social_images($post_id) {
    // This blocks post publication
    $image = imagecreatetruecolor(1200, 630);
    // ... complex image processing (5-10 seconds)
    // ... upload to CDN
}
```

**‚úÖ FAST: Queue for Background Processing**

```php
add_action('publish_post', 'queue_social_image_generation');

function queue_social_image_generation($post_id) {
    // Add to queue, process later via cron
    wp_schedule_single_event(time(), 'process_social_image', [$post_id]);
}

add_action('process_social_image', 'generate_social_images');

function generate_social_images($post_id) {
    // Runs in background via WP-Cron
    // Doesn't block user experience
}
```

### 6.9 Monitoring Performance

**Query Monitor Plugin (Development):**

```php
// Shows:
// - Total queries: 45
// - Page generation time: 1.2s
// - Memory usage: 45MB
// - Slowest queries highlighted
```

**New Relic / Application Performance Monitoring (Production):**

```php
// Tracks:
// - Real user response times
// - Slowest transactions
// - Database query performance
// - PHP errors and warnings
```

### 6.10 Performance Checklist

**Database:**

- [ ] Use `WP_Query` optimization flags
- [ ] Implement object caching
- [ ] Use transients for external API data
- [ ] Avoid N+1 query problems
- [ ] Index custom database tables

**Assets:**

- [ ] Minify CSS/JavaScript
- [ ] Load scripts in footer
- [ ] Use conditional loading
- [ ] Implement lazy loading for images
- [ ] Serve responsive images
- [ ] Use CDN for static assets

**Caching:**

- [ ] Enable object caching (Redis/Memcached)
- [ ] Implement page caching
- [ ] Use transient API for expensive operations
- [ ] Set appropriate cache expiration times

**Code:**

- [ ] Limit plugin count
- [ ] Audit plugin performance
- [ ] Use cron for background tasks
- [ ] Optimize database queries
- [ ] Profile with Query Monitor

---

## 7. Progressive Enhancement

### 7.1 Principle Definition

**Core Statement:** Build baseline features first, then layer on advanced experience. Supports accessibility, mobile-first strategy, and graceful degradation.

### 7.2 Progressive Enhancement Philosophy

```
Layer 3: JavaScript Enhancement (Optional)
         ‚Ä¢ Interactive features
         ‚Ä¢ Real-time updates
         ‚Ä¢ Enhanced UX
              ‚Üì
Layer 2: CSS Styling (Enhances)
         ‚Ä¢ Visual design
         ‚Ä¢ Layout
         ‚Ä¢ Responsive design
              ‚Üì
Layer 1: HTML Content (Required)
         ‚Ä¢ Semantic markup
         ‚Ä¢ Core functionality
         ‚Ä¢ Works without CSS/JS
```

### 7.3 Baseline Functionality Example

**Contact Form Without JavaScript:**

```html
<!-- Works even if JavaScript is disabled -->
<form method="post" action="<?php echo admin_url('admin-post.php'); ?>">
    <?php wp_nonce_field('contact_form', 'contact_nonce'); ?>
    <input type="hidden" name="action" value="submit_contact_form">
    
    <label for="name">Name:</label>
    <input type="text" name="name" id="name" required>
    
    <label for="email">Email:</label>
    <input type="email" name="email" id="email" required>
    
    <label for="message">Message:</label>
    <textarea name="message" id="message" required></textarea>
    
    <button type="submit">Send Message</button>
</form>

<?php
// Handle form submission (works without JS)
add_action('admin_post_submit_contact_form', 'handle_contact_form');
add_action('admin_post_nopriv_submit_contact_form', 'handle_contact_form');

function handle_contact_form() {
    // Verify nonce
    if (!wp_verify_nonce($_POST['contact_nonce'], 'contact_form')) {
        wp_die('Security check failed');
    }
    
    // Process form
    $name = sanitize_text_field($_POST['name']);
    $email = sanitize_email($_POST['email']);
    $message = sanitize_textarea_field($_POST['message']);
    
    // Send email
    wp_mail('admin@example.com', 'Contact Form Submission', $message);
    
    // Redirect back with success message
    wp_redirect(add_query_arg('contact', 'success', wp_get_referer()));
    exit;
}
?>
```

**Enhanced with JavaScript (AJAX):**

```javascript
// Progressive enhancement: Add AJAX if JavaScript available
jQuery(document).ready(function($) {
    $('#contact-form').on('submit', function(e) {
        e.preventDefault();  // Prevent default form submission
        
        var formData = $(this).serialize();
        formData += '&action=ajax_contact_form';
        
        $.ajax({
            url: ajaxurl,
            type: 'POST',
            data: formData,
            success: function(response) {
                if (response.success) {
                    $('#contact-form').html('<p>Thank you! Message sent.</p>');
                } else {
                    alert('Error: ' + response.data.message);
                }
            }
        });
    });
});
```

**Result:**

- JavaScript enabled: Smooth AJAX submission, no page reload
- JavaScript disabled: Still works via traditional form submission

### 7.4 Mobile-First Responsive Design

**CSS Mobile-First Approach:**

```css
/* Base styles: Mobile (320px+) */
.container {
    width: 100%;
    padding: 15px;
}

.grid-item {
    width: 100%;
    margin-bottom: 20px;
}

/* Tablet (768px+) */
@media (min-width: 768px) {
    .container {
        padding: 30px;
    }
    
    .grid-item {
        width: 48%;
        float: left;
        margin-right: 4%;
    }
}

/* Desktop (1024px+) */
@media (min-width: 1024px) {
    .container {
        max-width: 1200px;
        margin: 0 auto;
    }
    
    .grid-item {
        width: 30%;
        margin-right: 3.333%;
    }
}
```

### 7.5 Accessible HTML Structure

**Semantic HTML5:**

```html
<!-- ‚úÖ GOOD: Semantic markup -->
<article class="post">
    <header>
        <h1>Post Title</h1>
        <time datetime="2023-11-15">November 15, 2023</time>
    </header>
    
    <main>
        <p>Post content...</p>
    </main>
    
    <footer>
        <nav aria-label="Post navigation">
            <a href="#" rel="prev">Previous Post</a>
            <a href="#" rel="next">Next Post</a>
        </nav>
    </footer>
</article>

<!-- ‚ùå BAD: Non-semantic divs -->
<div class="post">
    <div class="title">Post Title</div>
    <div class="date">November 15, 2023</div>
    <div class="content">Post content...</div>
</div>
```

**ARIA Labels for Accessibility:**

```html
<!-- Screen reader support -->
<nav aria-label="Primary navigation">
    <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/about">About</a></li>
    </ul>
</nav>

<button aria-label="Close dialog" onclick="closeDialog()">
    <span aria-hidden="true">√ó</span>
</button>

<div role="alert" aria-live="polite" id="status-message">
    <!-- Announcements for screen readers -->
</div>
```

### 7.6 Feature Detection

```javascript
// Check if browser supports features before using
if ('IntersectionObserver' in window) {
    // Use Intersection Observer for lazy loading
    const observer = new IntersectionObserver(callback);
} else {
    // Fallback: Load all images immediately
    loadAllImages();
}

// Check for localStorage support
if (typeof Storage !== 'undefined') {
    localStorage.setItem('key', 'value');
} else {
    // Use cookies as fallback
    document.cookie = 'key=value';
}
```

### 7.7 Graceful Degradation

**Image Enhancement:**

```html
<!-- Base: Static image -->
<img src="product.jpg" alt="Product Name">

<!-- Enhanced: Responsive images -->
<img src="product-small.jpg"
     srcset="product-small.jpg 300w,
             product-medium.jpg 600w,
             product-large.jpg 1200w"
     sizes="(max-width: 600px) 300px,
            (max-width: 1200px) 600px,
            1200px"
     alt="Product Name">

<!-- Further enhanced: WebP with fallback -->
<picture>
    <source srcset="product.webp" type="image/webp">
    <source srcset="product.jpg" type="image/jpeg">
    <img src="product.jpg" alt="Product Name">
</picture>
```

### 7.8 WordPress Implementation

**Enqueue Scripts with Fallbacks:**

```php
function enqueue_enhanced_scripts() {
    // Base jQuery (works everywhere)
    wp_enqueue_script('jquery');
    
    // Enhanced: Custom interactions
    wp_enqueue_script(
        'enhanced-ui',
        get_template_directory_uri() . '/js/enhanced-ui.js',
        ['jquery'],
        '1.0.0',
        true
    );
    
    // Pass data to JavaScript
    wp_localize_script('enhanced-ui', 'siteConfig', [
        'ajax_url' => admin_url('admin-ajax.php'),
        'nonce' => wp_create_nonce('ajax_nonce'),
        'features' => [
            'ajax_enabled' => true,
            'lazy_load' => true
        ]
    ]);
}
add_action('wp_enqueue_scripts', 'enqueue_enhanced_scripts');
```

### 7.9 Real-World Example: Search Functionality

**Level 1: Basic HTML Form**

```html
<form method="get" action="<?php echo home_url('/'); ?>">
    <input type="search" name="s" placeholder="Search...">
    <button type="submit">Search</button>
</form>
```

**Level 2: Styled with CSS**

```css
.search-form {
    display: flex;
    max-width: 400px;
}

.search-form input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ccc;
}

.search-form button {
    padding: 10px 20px;
    background: #0073aa;
    color: white;
    border: none;
    cursor: pointer;
}
```

**Level 3: Enhanced with AJAX Autocomplete**

```javascript
jQuery(document).ready(function($) {
    var searchInput = $('.search-form input[name="s"]');
    var resultsContainer = $('<div class="autocomplete-results"></div>');
    searchInput.after(resultsContainer);
    
    searchInput.on('input', function() {
        var query = $(this).val();
        
        if (query.length < 3) {
            resultsContainer.hide();
            return;
        }
        
        $.ajax({
            url: ajaxurl,
            data: {
                action: 'autocomplete_search',
                query: query
            },
            success: function(response) {
                resultsContainer.html(response.data.html).show();
            }
        });
    });
});
```

**Result:**

- No JavaScript: Traditional search still works
- With JavaScript: Enhanced with autocomplete
- Screen readers: Still navigable and usable

### 7.10 Benefits of Progressive Enhancement

**Accessibility:**

- Works for users with disabilities
- Compatible with screen readers
- Keyboard navigable

**Performance:**

- Faster initial load (baseline HTML/CSS)
- JavaScript loads asynchronously
- Works on slow connections

**Reliability:**

- Functional even if JavaScript fails
- Works across all browsers
- Degrades gracefully

**SEO:**

- Content accessible to crawlers
- Semantic HTML improves indexing
- Fast baseline load time

---

## 8. Open-Source Community Collaboration

### 8.1 Principle Definition

**Core Statement:** Development shaped by shared standards, transparent evolution, widespread peer review, and continuous improvement through contribution.

### 8.2 Community Structure

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           WORDPRESS COMMUNITY                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Core Team    ‚îÇ    ‚îÇ  Plugin Authors  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ (Leadership) ‚îÇ    ‚îÇ  (60,000+ plugins)‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Contributors ‚îÇ    ‚îÇ  Theme Designers ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ (Global)     ‚îÇ    ‚îÇ  (11,000+ themes)‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ      Documentation Writers           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ      Translators (200+ languages)    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ      Support Forum Volunteers        ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 8.3 Contribution Pathways

**Code Contributions:**

```bash
# 1. Find an issue on Trac (https://core.trac.wordpress.org/)
# 2. Create patch
svn checkout https://develop.svn.wordpress.org/trunk/ wordpress-develop
cd wordpress-develop
# Make changes
svn diff > 12345.patch

# 3. Upload to Trac ticket
# 4. Await peer review
# 5. Iterate based on feedback
```

**Plugin/Theme Development:**

```php
/**
 * Plugin Name: Community Plugin
 * Description: Example of community contribution
 * Version: 1.0.0
 * Author: Community Developer
 * License: GPL v2 or later
 */

// All plugins in repository must be GPL-compatible
// This ensures freedom to:
// - Use for any purpose
// - Study how it works
// - Redistribute copies
// - Improve and share improvements
```

### 8.4 WordPress Coding Standards

**PHP Standards:**

```php
// ‚úÖ CORRECT: WordPress coding style
function calculate_product_price( $product_id, $quantity = 1 ) {
    $base_price = get_post_meta( $product_id, '_price', true );
    $discount   = get_product_discount( $product_id );
    
    if ( $quantity >= 10 ) {
        $discount += 0.10; // Bulk discount
    }
    
    $final_price = $base_price * $quantity * ( 1 - $discount );
    
    return apply_filters( 'product_final_price', $final_price, $product_id, $quantity );
}

// Naming conventions:
// - Functions: lowercase_with_underscores()
// - Classes: Capitalized_With_Underscores
// - Constants: UPPERCASE_WITH_UNDERSCORES
// - Variables: $lowercase_with_underscores
```

**Documentation Standards:**

```php
/**
 * Calculate the final price for a product.
 *
 * Applies base price, discounts, and quantity-based pricing.
 * Filters allow modification of the final calculated price.
 *
 * @since 1.0.0
 *
 * @param int $product_id The product post ID.
 * @param int $quantity   Optional. Quantity purchased. Default 1.
 * @return float The final calculated price.
 */
function calculate_product_price( $product_id, $quantity = 1 ) {
    // Implementation
}
```

### 8.5 Peer Review Process

**Plugin Review Guidelines:**

```
1. Security Review
   ‚úì Nonce verification
   ‚úì Capability checks
   ‚úì Data sanitization
   ‚úì SQL injection prevention

2. Code Quality Review
   ‚úì WordPress coding standards
   ‚úì No PHP errors/warnings
   ‚úì Proper escaping
   ‚úì Internationalization ready

3. Functionality Review
   ‚úì Works as described
   ‚úì No conflicts with core
   ‚úì Documented features
   ‚úì Uninstall cleanup

4. License Review
   ‚úì GPL-compatible
   ‚úì Proper attribution
   ‚úì No proprietary dependencies
```

### 8.6 Translation & Internationalization

**Making Code Translation-Ready:**

```php
// ‚úÖ CORRECT: Translatable strings
echo esc_html__( 'Welcome to our site', 'text-domain' );

printf(
    /* translators: %s: user name */
    esc_html__( 'Hello, %s!', 'text-domain' ),
    $user_name
);

// Plural forms
printf(
    /* translators: %d: number of items */
    esc_html( _n(
        'You have %d item in your cart.',
        'You have %d items in your cart.',
        $count,
        'text-domain'
    ) ),
    $count
);

// JavaScript translations (WordPress 5.0+)
wp_set_script_translations( 'my-script', 'text-domain' );
```

**Community Translation Platform:**

```
translate.wordpress.org
‚îú‚îÄ‚îÄ Core translations (200+ languages)
‚îú‚îÄ‚îÄ Plugin translations
‚îú‚îÄ‚îÄ Theme translations
‚îî‚îÄ‚îÄ Documentation translations
```

### 8.7 Support Forums & Documentation

**Community Support Structure:**

```
wordpress.org/support/
‚îú‚îÄ‚îÄ Plugin-specific forums
‚îú‚îÄ‚îÄ Theme-specific forums
‚îú‚îÄ‚îÄ Installation & Setup
‚îú‚îÄ‚îÄ Using WordPress
‚îî‚îÄ‚îÄ Requests & Feedback
```

**Documentation Contributions:**

```
developer.wordpress.org
‚îú‚îÄ‚îÄ Code Reference (auto-generated from inline docs)
‚îú‚îÄ‚îÄ Plugin Handbook
‚îú‚îÄ‚îÄ Theme Handbook
‚îú‚îÄ‚îÄ REST API Handbook
‚îî‚îÄ‚îÄ Common APIs Handbook
```

### 8.8 WordCamps & Meetups

**Global Community Events:**

```
WordCamp (Annual conferences)
‚îú‚îÄ‚îÄ WordCamp US (flagship event)
‚îú‚îÄ‚îÄ WordCamp Europe
‚îú‚îÄ‚îÄ WordCamp Asia
‚îî‚îÄ‚îÄ 100+ city-specific WordCamps

WordPress Meetups
‚îî‚îÄ‚îÄ 750+ local meetup groups worldwide
```

### 8.9 Core Release Cycle

**Version Release Process:**

```
Phase 1: Planning (2-3 months before)
         ‚Ä¢ Feature proposals
         ‚Ä¢ Community discussion
         ‚Ä¢ Roadmap finalization

Phase 2: Development (2-3 months)
         ‚Ä¢ Feature implementation
         ‚Ä¢ Continuous testing
         ‚Ä¢ Beta releases

Phase 3: Beta Testing (4-6 weeks)
         ‚Ä¢ Beta 1, 2, 3... releases
         ‚Ä¢ Bug fixes
         ‚Ä¢ Community testing

Phase 4: Release Candidate (2-3 weeks)
         ‚Ä¢ RC1, RC2... releases
         ‚Ä¢ Final bug fixes
         ‚Ä¢ Translation completion

Phase 5: Final Release
         ‚Ä¢ Version launch
         ‚Ä¢ Update push to all sites
         ‚Ä¢ Post-release monitoring
```

### 8.10 Benefits of Open-Source Model

**For Developers:**

- Access to complete source code
- Learn from high-quality codebase
- Portfolio building through contributions
- Global recognition

**For Businesses:**

- No vendor lock-in
- Freedom to customize
- Transparent security auditing
- Lower total cost of ownership

**For Users:**

- Free software
- Large support community
- Constant improvements
- Choice of thousands of extensions

**For the Ecosystem:**

- Rapid innovation
- Distributed security review
- Shared knowledge base
- Economic opportunity

---

### 9. Interconnection of Principles (continued)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     BACKWARD COMPATIBILITY COMMITMENT         ‚îÇ
‚îÇ  Enables long-term stability for all layers   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                       ‚îÇ
    ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SEPARATION  ‚îÇ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  EXTENSIBILITY  ‚îÇ
‚îÇ OF CONCERNS ‚îÇ     ‚îÇ   VIA HOOKS     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                     ‚îÇ
       ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ   ‚îÇ
       ‚ñº   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   PERFORMANCE    ‚îÇ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ  PROGRESSIVE       ‚îÇ
‚îÇ     FIRST        ‚îÇ      ‚îÇ  ENHANCEMENT       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                          ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ  LEAST PRIV.   ‚îÇ
         ‚îÇ   SECURITY     ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ  OPEN SOURCE   ‚îÇ
         ‚îÇ  COMMUNITY     ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Example: How Principles Work Together**

When developing a new e-commerce plugin:

1. **Separation of Concerns**: Business logic in plugin, display in theme
2. **Extensibility via Hooks**: Provide actions/filters for other developers
3. **Least Privilege**: Check capabilities before processing payments
4. **Backward Compatibility**: Support older WordPress versions where reasonable
5. **Performance First**: Cache product queries, optimize database
6. **Progressive Enhancement**: Forms work without JavaScript, enhanced with AJAX
7. **Open Source**: Released under GPL, documented, community-reviewed

---

## 10. Practical Application Case Study

### Scenario: Building a Membership Site

**Requirements:**

- User registration and profiles
- Subscription management
- Content restriction based on membership level
- Payment processing
- Email notifications

### Applying Core Principles

**1. Separation of Concerns**

```php
// ‚ùå WRONG: Everything in theme
// functions.php (theme)
function process_membership_payment() {
    // Payment logic in theme
    // If theme changes, payments break!
}

// ‚úÖ CORRECT: Logic in plugin, display in theme
// Plugin: membership-system.php
function process_membership_payment($user_id, $plan_id) {
    // Business logic here
    $payment_gateway = new PaymentGateway();
    $result = $payment_gateway->charge($user_id, $plan_id);
    
    if ($result['success']) {
        update_user_meta($user_id, 'membership_level', $plan_id);
        do_action('membership_payment_complete', $user_id, $plan_id);
    }
    
    return $result;
}

// Theme: membership-account.php
<div class="membership-status">
    <h2>Your Membership</h2>
    <p>Level: <?php echo esc_html(get_user_meta(get_current_user_id(), 'membership_level', true)); ?></p>
    <a href="<?php echo esc_url(home_url('/upgrade')); ?>">Upgrade</a>
</div>
```

**2. Extensibility via Hooks**

```php
// Plugin provides hooks for extensibility
class Membership_System {
    
    public function register_user($data) {
        // Allow modification of registration data
        $data = apply_filters('membership_registration_data', $data);
        
        // Create user
        $user_id = wp_insert_user($data);
        
        if (!is_wp_error($user_id)) {
            // Trigger action for other plugins
            do_action('membership_user_registered', $user_id, $data);
        }
        
        return $user_id;
    }
    
    public function upgrade_membership($user_id, $new_level) {
        $old_level = get_user_meta($user_id, 'membership_level', true);
        
        // Allow plugins to prevent upgrade
        $can_upgrade = apply_filters('membership_can_upgrade', true, $user_id, $old_level, $new_level);
        
        if (!$can_upgrade) {
            return false;
        }
        
        update_user_meta($user_id, 'membership_level', $new_level);
        
        // Trigger upgrade event
        do_action('membership_upgraded', $user_id, $old_level, $new_level);
        
        return true;
    }
}

// Other plugins can extend functionality
add_action('membership_upgraded', 'send_upgrade_notification', 10, 3);

function send_upgrade_notification($user_id, $old_level, $new_level) {
    $user = get_userdata($user_id);
    $subject = 'Membership Upgraded!';
    $message = "Your membership has been upgraded from {$old_level} to {$new_level}.";
    
    wp_mail($user->user_email, $subject, $message);
}

// Loyalty plugin adds bonus for upgrades
add_filter('membership_registration_data', 'add_referral_bonus');

function add_referral_bonus($data) {
    if (!empty($_GET['ref'])) {
        $referrer_id = absint($_GET['ref']);
        award_referral_bonus($referrer_id);
        $data['referred_by'] = $referrer_id;
    }
    return $data;
}
```

**3. Least Privilege Security Model**

```php
// Define custom capabilities
register_activation_hook(__FILE__, 'create_membership_roles');

function create_membership_roles() {
    // Premium member role
    add_role('premium_member', 'Premium Member', [
        'read' => true,
        'access_premium_content' => true,
        'download_resources' => true
    ]);
    
    // Basic member role
    add_role('basic_member', 'Basic Member', [
        'read' => true,
        'access_basic_content' => true
    ]);
}

// Content restriction
function restrict_premium_content($content) {
    if (!is_singular('premium_resource')) {
        return $content;
    }
    
    // Check capability, not role
    if (current_user_can('access_premium_content')) {
        return $content;
    }
    
    // Show upgrade message
    return '<div class="access-denied">
        <p>This content is only available to Premium members.</p>
        <a href="' . esc_url(home_url('/upgrade')) . '">Upgrade Now</a>
    </div>';
}
add_filter('the_content', 'restrict_premium_content');

// Protect admin pages
function render_membership_admin_page() {
    if (!current_user_can('manage_options')) {
        wp_die(__('You do not have sufficient permissions to access this page.'));
    }
    
    // Render admin interface
}

// Protect REST API endpoints
register_rest_route('membership/v1', '/user/(?P<id>\d+)', [
    'methods' => 'GET',
    'callback' => 'get_membership_data',
    'permission_callback' => function($request) {
        $user_id = $request['id'];
        // Can only view own data unless admin
        return get_current_user_id() === $user_id || current_user_can('manage_options');
    }
]);

// Secure payment processing
function process_payment_request() {
    // Verify nonce
    if (!check_ajax_referer('payment_nonce', 'nonce', false)) {
        wp_send_json_error(['message' => 'Security check failed']);
        return;
    }
    
    // Verify user is logged in
    if (!is_user_logged_in()) {
        wp_send_json_error(['message' => 'You must be logged in']);
        return;
    }
    
    // Sanitize input
    $plan_id = sanitize_text_field($_POST['plan_id']);
    $amount = floatval($_POST['amount']);
    
    // Process payment
    $result = process_membership_payment(get_current_user_id(), $plan_id);
    
    wp_send_json_success($result);
}
```

**4. Backward Compatibility**

```php
// Support older WordPress versions
function enqueue_membership_assets() {
    // Check if wp_enqueue_media exists (WP 3.5+)
    if (function_exists('wp_enqueue_media')) {
        wp_enqueue_media();
    } else {
        // Fallback for older versions
        wp_enqueue_script('media-upload');
        wp_enqueue_script('thickbox');
        wp_enqueue_style('thickbox');
    }
    
    // Use new hook if available, fallback to old
    if (has_action('wp_body_open')) {
        add_action('wp_body_open', 'add_membership_notice');
    } else {
        add_action('wp_footer', 'add_membership_notice');
    }
}

// Deprecate old function gracefully
function old_membership_function() {
    _deprecated_function(__FUNCTION__, '2.0.0', 'new_membership_function()');
    return new_membership_function();
}

// Check WordPress version for features
if (version_compare(get_bloginfo('version'), '5.0', '>=')) {
    // Use Gutenberg blocks
    register_block_type('membership/restricted-content', [
        'render_callback' => 'render_restricted_block'
    ]);
} else {
    // Use shortcodes for older versions
    add_shortcode('membership_content', 'render_restricted_shortcode');
}
```

**5. Performance First**

```php
// Cache membership data
function get_user_membership_level($user_id) {
    $cache_key = 'membership_level_' . $user_id;
    $level = wp_cache_get($cache_key, 'membership');
    
    if (false === $level) {
        $level = get_user_meta($user_id, 'membership_level', true);
        wp_cache_set($cache_key, $level, 'membership', 3600);
    }
    
    return $level;
}

// Optimize membership queries
function get_premium_members() {
    $cache_key = 'premium_members_list';
    $members = get_transient($cache_key);
    
    if (false === $members) {
        $members = get_users([
            'role' => 'premium_member',
            'fields' => ['ID', 'display_name', 'user_email'],
            'number' => 100
        ]);
        
        set_transient($cache_key, $members, HOUR_IN_SECONDS);
    }
    
    return $members;
}

// Lazy load membership checks
function check_content_access($post_id) {
    static $access_cache = [];
    
    if (isset($access_cache[$post_id])) {
        return $access_cache[$post_id];
    }
    
    $required_level = get_post_meta($post_id, '_required_membership', true);
    $user_level = get_user_membership_level(get_current_user_id());
    
    $has_access = membership_level_sufficient($user_level, $required_level);
    $access_cache[$post_id] = $has_access;
    
    return $has_access;
}

// Process payments asynchronously
function handle_membership_signup($user_id, $plan_id) {
    // Queue payment processing
    wp_schedule_single_event(time(), 'process_membership_payment_async', [
        'user_id' => $user_id,
        'plan_id' => $plan_id
    ]);
    
    // Immediately show pending status
    update_user_meta($user_id, 'membership_status', 'pending');
    
    return ['status' => 'pending', 'message' => 'Processing your membership...'];
}

add_action('process_membership_payment_async', 'process_payment_background');

function process_payment_background($args) {
    // Actual payment processing happens in background
    $result = charge_payment($args['user_id'], $args['plan_id']);
    
    if ($result['success']) {
        update_user_meta($args['user_id'], 'membership_status', 'active');
        send_welcome_email($args['user_id']);
    }
}
```

**6. Progressive Enhancement**

```php
// Base membership form (works without JavaScript)
?>
<form method="post" action="<?php echo admin_url('admin-post.php'); ?>" id="membership-form">
    <?php wp_nonce_field('membership_signup', 'membership_nonce'); ?>
    <input type="hidden" name="action" value="membership_signup">
    
    <label>
        <input type="radio" name="plan" value="basic" checked> 
        Basic - $9.99/month
    </label>
    
    <label>
        <input type="radio" name="plan" value="premium"> 
        Premium - $19.99/month
    </label>
    
    <button type="submit">Sign Up</button>
    
    <div id="loading-indicator" style="display:none;">Processing...</div>
</form>

<script>
// Progressive enhancement: Add AJAX
jQuery(document).ready(function($) {
    $('#membership-form').on('submit', function(e) {
        e.preventDefault();
        
        var form = $(this);
        var submitBtn = form.find('button[type="submit"]');
        var loadingIndicator = $('#loading-indicator');
        
        submitBtn.prop('disabled', true);
        loadingIndicator.show();
        
        $.ajax({
            url: '<?php echo admin_url('admin-ajax.php'); ?>',
            type: 'POST',
            data: form.serialize() + '&action=ajax_membership_signup',
            success: function(response) {
                if (response.success) {
                    form.html('<div class="success-message">' + 
                             response.data.message + '</div>');
                } else {
                    alert('Error: ' + response.data.message);
                    submitBtn.prop('disabled', false);
                    loadingIndicator.hide();
                }
            },
            error: function() {
                alert('An error occurred. Please try again.');
                submitBtn.prop('disabled', false);
                loadingIndicator.hide();
            }
        });
    });
});
</script>
<?php

// Mobile-first responsive CSS
?>
<style>
/* Base: Mobile (320px+) */
.membership-plans {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.plan-card {
    padding: 20px;
    border: 2px solid #ddd;
    border-radius: 8px;
}

/* Tablet (768px+) */
@media (min-width: 768px) {
    .membership-plans {
        flex-direction: row;
    }
    
    .plan-card {
        flex: 1;
    }
}

/* Desktop (1024px+) */
@media (min-width: 1024px) {
    .membership-plans {
        max-width: 1200px;
        margin: 0 auto;
    }
}
</style>
```

**7. Open Source Community**

```php
/**
 * Plugin Name: Membership System
 * Plugin URI: https://example.com/membership-system
 * Description: Complete membership management solution
 * Version: 1.0.0
 * Author: Your Name
 * Author URI: https://example.com
 * License: GPL v2 or later
 * License URI: https://www.gnu.org/licenses/gpl-2.0.html
 * Text Domain: membership-system
 * Domain Path: /languages
 */

// Make translatable
load_plugin_textdomain('membership-system', false, dirname(plugin_basename(__FILE__)) . '/languages');

// Follow WordPress coding standards
function membership_get_user_plan( $user_id ) {
    return get_user_meta( $user_id, 'membership_plan', true );
}

// Document thoroughly
/**
 * Get the active membership plan for a user.
 *
 * Returns the current membership plan slug for the specified user.
 * If the user has no active plan, returns false.
 *
 * @since 1.0.0
 *
 * @param int $user_id User ID to check.
 * @return string|false Plan slug or false if no active plan.
 */
function membership_get_active_plan( $user_id ) {
    $plan = get_user_meta( $user_id, 'membership_plan', true );
    
    if ( empty( $plan ) ) {
        return false;
    }
    
    return $plan;
}

// Provide hooks for community extensions
do_action( 'membership_before_content_restriction', $post_id );
$content = apply_filters( 'membership_restricted_content_message', $default_message, $post_id );

// Include README.txt for WordPress.org repository
/*
=== Membership System ===
Contributors: yourusername
Tags: membership, subscription, paywall
Requires at least: 5.0
Tested up to: 6.4
Requires PHP: 7.4
Stable tag: 1.0.0
License: GPLv2 or later

Complete membership management solution for WordPress.

== Description ==

Full-featured membership system with:
* Multiple membership levels
* Content restriction
* Payment integration
* Email notifications

== Installation ==

1. Upload plugin to /wp-content/plugins/
2. Activate through 'Plugins' menu
3. Configure in Settings > Membership

== Changelog ==

= 1.0.0 =
* Initial release
*/
```

---

## 11. Anti-Patterns to Avoid

### 11.1 Violating Separation of Concerns

**‚ùå WRONG:**

```php
// Theme: functions.php
// Storing critical business logic in theme
function process_order_payment($order_id) {
    $stripe = new StripeAPI();
    return $stripe->charge($order_id);
}

// Problem: Switching themes breaks order processing
```

### 11.2 Modifying Core Files

**‚ùå WRONG:**

```php
// Editing /wp-includes/post.php
function wp_insert_post($postarr, $wp_error = false) {
    // Adding custom logic to core function
    // Problem: Lost on WordPress updates
}
```

**‚úÖ CORRECT:**

```php
// Using hooks instead
add_filter('wp_insert_post_data', 'modify_post_before_save', 10, 2);

function modify_post_before_save($data, $postarr) {
    // Custom logic here
    return $data;
}
```

### 11.3 Ignoring Capabilities

**‚ùå WRONG:**

```php
// Checking user role
if (in_array('administrator', $user->roles)) {
    // Allow action
}
```

**‚úÖ CORRECT:**

```php
// Checking capability
if (current_user_can('manage_options')) {
    // Allow action
}
```

### 11.4 Not Sanitizing/Escaping

**‚ùå WRONG:**

```php
// Direct output without escaping
echo $_POST['user_input'];

// Direct database query
$wpdb->query("SELECT * FROM {$wpdb->posts} WHERE ID = {$_GET['id']}");
```

**‚úÖ CORRECT:**

```php
// Escape output
echo esc_html($_POST['user_input']);

// Prepared statement
$wpdb->get_results($wpdb->prepare(
    "SELECT * FROM {$wpdb->posts} WHERE ID = %d",
    $_GET['id']
));
```

### 11.5 Inefficient Queries

**‚ùå WRONG:**

```php
// N+1 query problem
$posts = get_posts(['numberposts' => 100]);
foreach ($posts as $post) {
    $author = get_user_by('id', $post->post_author); // 100 queries
}
```

**‚úÖ CORRECT:**

```php
// Batch load with cache
$posts = get_posts([
    'numberposts' => 100,
    'update_post_meta_cache' => true
]);

// Or use WP_Query with author data
$query = new WP_Query([
    'posts_per_page' => 100,
    'fields' => 'all_with_meta'
]);
```

### 11.6 Hardcoding Values

**‚ùå WRONG:**

```php
$admin_email = 'admin@example.com';
$site_url = 'https://example.com';
```

**‚úÖ CORRECT:**

```php
$admin_email = get_option('admin_email');
$site_url = home_url();
```

### 11.7 Not Using Hooks

**‚ùå WRONG:**

```php
// Modifying plugin files directly to add functionality
// Problem: Lost on plugin updates
```

**‚úÖ CORRECT:**

```php
// Using hooks provided by the plugin
add_filter('plugin_output', 'modify_plugin_output');

function modify_plugin_output($output) {
    return $output . ' - Modified';
}
```

---

## 12. Conclusion

The seven core principles of WordPress engineering form an interconnected philosophy that has enabled WordPress to become the world's most popular content management system:

1. **Separation of Concerns** ensures modularity and maintainability
2. **Extensibility via Hooks** enables infinite customization without core modifications
3. **Least Privilege Security Model** protects sites through capability-based access control
4. **Backward Compatibility Commitment** provides stability for long-term deployments
5. **Performance First Discipline** ensures scalability under real-world load
6. **Progressive Enhancement** supports accessibility and graceful degradation
7. **Open Source Community Collaboration** drives continuous improvement

### Key Takeaways

**For Developers:**

- Always use hooks instead of modifying core/plugin files
- Check capabilities, not roles
- Separate business logic (plugins) from presentation (themes)
- Write performant queries and implement caching
- Build accessible, progressively enhanced interfaces
- Follow WordPress coding standards
- Document and internationalize your code

**For Architects:**

- Design systems that respect WordPress's architectural boundaries
- Plan for backward compatibility and upgrade paths
- Implement proper security layers
- Optimize for performance from the start
- Build for extensibility through custom hooks
- Consider mobile-first, accessible design

**For Organizations:**

- Trust in WordPress's stability for long-term projects
- Leverage the open-source ecosystem
- Contribute back to the community
- Invest in proper WordPress training
- Follow best practices for sustainable development

### Moving Forward

These principles are not theoretical‚Äîthey are proven patterns that have scaled WordPress from a simple blogging tool to an enterprise-grade application platform. By understanding and applying these principles, developers can:

- Build maintainable, scalable WordPress applications
- Create secure, performant systems
- Contribute meaningfully to the WordPress ecosystem
- Make informed architectural decisions
- Future-proof their WordPress projects

The next sections of this learning material will build upon these foundational principles, exploring practical implementation patterns, advanced techniques, and real-world scenarios that demonstrate how these principles manifest in production WordPress environments.

---

## 13. References & Further Reading

**Official Resources:**

- WordPress Developer Handbook: https://developer.wordpress.org/
- WordPress Coding Standards: https://developer.wordpress.org/coding-standards/
- Plugin Developer Handbook: https://developer.wordpress.org/plugins/
- Theme Developer Handbook: https://developer.wordpress.org/themes/
- WordPress Security White Paper: https://wordpress.org/about/security/

**Community Resources:**

- WordPress.tv: Video tutorials and WordCamp talks
- Make WordPress: Core development blog
- WordPress Support Forums: Community assistance
- WordPress Slack: Real-time community chat

**Performance Resources:**

- Query Monitor Plugin: Development debugging tool
- WordPress Performance Team: Official performance guidelines
- Web.dev WordPress guides: Google's performance recommendations

**Security Resources:**

- WordPress Security Team: Official security advisories
- WPScan: Vulnerability database
- Security plugins: Wordfence, Sucuri, iThemes Security

---

**Document Version:** 1.0  
**Last Updated:** November 2025  
**Section:** 1.2 Core Principles ‚Äî Foundational Engineering Philosophy  
**Target Audience:** WordPress Engineers, Developers, Technical Architects  
**Prerequisite Knowledge:** Section 1.1 (Essential WordPress Terms & Core Concepts)  
**Next Section:** 1.3 System Architecture & Request Lifecycle

---

**End of Section 1.2**